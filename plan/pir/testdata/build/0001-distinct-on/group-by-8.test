SELECT DISTINCT ON (y) COUNT(*) AS n FROM input GROUP BY x, y
---
ITERATE input FIELDS [x, y]
AGGREGATE COUNT(*) AS $_0_0 BY x, y AS $_0_1
PROJECT $_0_1 AS y, $_0_0 AS n
FILTER DISTINCT [y]
PROJECT n AS n
